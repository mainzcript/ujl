# GitLab CI/CD Pipeline for UJL Framework
# Simple quality checks for MVP

stages:
  - quality

variables:
  NODE_VERSION: '22-slim'
  PNPM_VERSION: '10.19.0'

# Install dependencies and run quality checks
quality_check:
  stage: quality
  image: node:${NODE_VERSION}
  before_script:
    - corepack enable
    - corepack prepare pnpm@${PNPM_VERSION} --activate
  script:
    - pnpm install --frozen-lockfile
    - pnpm run build
    - pnpm run lint
    - pnpm run check
  cache:
    key: ${CI_COMMIT_REF_SLUG}
    paths:
      - node_modules/
      - .pnpm-store/
      - '**/node_modules/'
      - '**/.svelte-kit/'
  retry:
    max: 2
    when:
      - runner_system_failure
      - stuck_or_timeout_failure
